#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#define MAX 10

#define SUCCESS 1
#define FAILURE 0

 typedef struct node{
    int data;
    struct node *link;
}node;

// Function Prototypes
node *newE();
node *push(struct node *pTop, int data);
node *pop(struct node *pTop,int *status, int *data);
node *traversal(struct node *pTop);
void read (int *value);
void write(int status, int value);



int main(void){
    node *pTop;
    int value, status;
    char choice[MAX];

    pTop = NULL;

    do{
        fprintf(stdout,"Push (p) Pop (o) Traversal (t) End(e):\n");
        scanf("%s", choice);

        if(strcmp(choice,"p")==0){

            read(&value);
            pTop = push(pTop,value);
            pTop = traversal(pTop);

        }else if(strcmp(choice,"o")==0){

            pTop = pop(pTop, &status,&value);
            write(status,value);
            pTop = traversal(pTop);

        }else{
            if(strcmp(choice,"t")==0){
                pTop = traversal(pTop);
            }else{
                if(strcmp(choice,"e")!=0){
                    fprintf(stdout,"Wrong Input\n");
                }
            }
        }

    } while (strcmp(choice,"e")!=0);

    return (EXIT_SUCCESS);
}

node *newE(){
    node *ptr = (node *) malloc(sizeof (node));
    if(ptr==NULL){
        fprintf(stdout,"memory allocation failed\n");
        exit(EXIT_FAILURE);
    }
    return (ptr);
}

node *push(struct node *pTop, int data){
    node *ptr = (node *) malloc(sizeof (node));
    if(ptr==NULL){
        fprintf(stdout,"memory allocation failed\n");
        exit(EXIT_FAILURE);
    }
    ptr->data = data;
    ptr->link = pTop;

    pTop = ptr;

    return (pTop);

}

node *pop(struct node *pTop,int *status, int *data) {
    node *ptr;
    if (pTop != NULL) {
        ptr = pTop;
        *status = SUCCESS;
        *data = ptr->data;
        pTop = pTop->link;
        free(ptr);
    } else {
        *status = FAILURE;
    }
    return (pTop);
}

node *traversal(struct node *pTop){
    node *ptr = pTop;
    fprintf(stdout,"pTop -> ");
    while (ptr!=NULL){
        fprintf(stdout,"%d ->",ptr->data);
        ptr = ptr->link;
    }
    fprintf(stdout," NULL\n");
    return (pTop);
}

void read (int *value){
    fprintf(stdout,"Insert a value:\n");
    scanf("%d", value);

    return;
}

void write(int status, int value){

    if(status==SUCCESS){
        fprintf(stdout,"Element %d is popped successfully\n",value);
    }else{
        fprintf(stdout,"Stack is empty\n");
    }
}
